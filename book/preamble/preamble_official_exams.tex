\documentclass[12pt]{article}

% Page size and tighter margins
\usepackage[a4paper,left=1.2cm,right=1.2cm,top=1.5cm,bottom=1.5cm]{geometry}

% Core packages
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{array}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{enumitem}

\setlength{\parindent}{0pt}
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.15}

% Column types
\newcolumntype{Y}{>{\raggedright\arraybackslash}m{\dimexpr0.30\textwidth-2\tabcolsep-2\arrayrulewidth\relax}}
\newcolumntype{Z}{>{\raggedright\arraybackslash}m{\dimexpr0.70\textwidth-2\tabcolsep-2\arrayrulewidth\relax}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}

% Gray subsection header box
\newcommand{\SubsectionBox}[1]{%
	\noindent\colorbox{gray!30}{%
		\parbox{\linewidth}{\textbf{#1}}%
	}\par\vspace{-0.55cm}%
}

% Centered multi-line cell helper
\newcommand{\CellCenter}[1]{%
	\parbox{\linewidth}{\centering #1}%
}

\newcommand{\ExamNameField}{\noindent\textbf{Name:}\ \rule{0.7\linewidth}{0.4pt}\par\medskip}

\newcommand{\ExamTitleBlock}[3]{%
	\begin{center}
		\Large\textbf{#1}\\
		\textbf{#2}%
		\if\relax\detokenize{#3}\relax\else\\\textbf{#3}\fi
	\end{center}
	\vspace{0.5em}
}

\newcommand{\ExamSection}[1]{\par\medskip\textbf{#1}\par\smallskip}

\newenvironment{ExamCriteria}{%
	\begin{itemize}[leftmargin=1.6em, itemsep=0.3em, topsep=0.2em]
}{%
	\end{itemize}
}

\newenvironment{ExamProblems}{%
	\begin{enumerate}[label=\textbf{Problem \arabic*:}, leftmargin=0pt, labelsep=0.6em, itemindent=2.2em, itemsep=0.8em]
}{%
	\end{enumerate}
}
